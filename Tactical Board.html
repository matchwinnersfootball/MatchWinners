<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Tactical Board</title>
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500;700&display=swap" rel="stylesheet" />
  <style>
    * {
      box-sizing: border-box;
      font-family: 'Orbitron', sans-serif;
      user-select: none;
    }

    body {
      margin: 0;
      background: #0d0d0d;
      color: #fff;
      overflow: hidden;
    }

    #toolbar {
      position: fixed;
      top: 10px;
      left: 10px;
      z-index: 10;
      display: flex;
      gap: 8px;
      flex-direction: column;
      background: rgba(0, 0, 0, 0.7);
      padding: 12px;
      border-radius: 10px;
      box-shadow: 0 0 10px #00f0ff;
    }

    .tool {
      background: #00f0ff;
      color: #000;
      border: none;
      padding: 6px 10px;
      font-weight: 700;
      border-radius: 6px;
      cursor: pointer;
      transition: 0.2s;
    }
    .tool:hover {
      transform: scale(1.1);
      box-shadow: 0 0 10px #00f0ff;
    }

    #board {
      position: relative;
      width: min(95vw, 1200px);
      aspect-ratio: 2 / 1;
      margin: 60px auto 0;
      background: url('—Pngtree—football pitch vector illustration design_6391956.png') center / cover no-repeat;
      border: 2px solid #00f0ff;
      border-radius: 8px;
    }

    .player {
      position: absolute;
      width: 42px;
      height: 42px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      color: #fff;
      font-weight: 700;
      cursor: pointer;
      transition: transform 0.2s;
    }
    .player.selected {
      transform: scale(1.3);
      box-shadow: 0 0 12px #fff;
    }
    .purple {
      background: #7c3aed;
    }
    .blue {
      background: #2563ff;
    }

    .label {
      position: absolute;
      color: #00f0ff;
      background: rgba(0, 0, 0, 0.7);
      padding: 4px 8px;
      font-size: 12px;
      border-radius: 4px;
    }
  </style>
</head>
<body>
  <div id="toolbar">
    <button class="tool" onclick="addLabel('Pass')">Pass</button>
    <button class="tool" onclick="addLabel('Shoot')">Shoot</button>
    <button class="tool" onclick="addLabel('Cross')">Cross</button>
    <button class="tool" id="saveBtn">Save</button>
    <button class="tool" id="loadBtn">Load</button>
    <input type="file" id="fileInput" accept="application/json" hidden />
  </div>

  <div id="board"></div>

  <script>
    const board = document.getElementById('board');
    const fileInput = document.getElementById('fileInput');
    let selected = null;

    function createPlayer(num, color, x, y) {
      const el = document.createElement('div');
      el.className = `player ${color}`;
      el.textContent = num;
      el.style.left = `${x}px`;
      el.style.top = `${y}px`;
      el.dataset.num = num;
      el.dataset.color = color;
      board.appendChild(el);
      return el;
    }

    function spawnInitialPlayers() {
      const rect = board.getBoundingClientRect();
      for (let i = 1; i <= 11; i++) {
        createPlayer(i, 'purple', 20, i * 50);
        createPlayer(i, 'blue', rect.width - 60, i * 50);
      }
    }

    function handleClick(e) {
      if (e.target.classList.contains('player')) {
        if (!selected) {
          selected = e.target;
          selected.classList.add('selected');
        } else if (selected === e.target) {
          selected.classList.remove('selected');
          selected = null;
        } else {
          const tmpLeft = selected.style.left;
          const tmpTop = selected.style.top;
          selected.style.left = e.target.style.left;
          selected.style.top = e.target.style.top;
          e.target.style.left = tmpLeft;
          e.target.style.top = tmpTop;
          selected.classList.remove('selected');
          selected = null;
        }
      } else if (selected) {
        const rect = board.getBoundingClientRect();
        selected.style.left = `${e.clientX - rect.left - 21}px`;
        selected.style.top = `${e.clientY - rect.top - 21}px`;
        selected.classList.remove('selected');
        selected = null;
      }
    }

    function addLabel(type) {
      const lbl = document.createElement('div');
      lbl.className = 'label';
      lbl.textContent = type;
      lbl.style.left = '50%';
      lbl.style.top = '50%';
      board.appendChild(lbl);
    }

    function collectBoardData() {
      const players = Array.from(document.querySelectorAll('.player')).map(p => ({
        num: p.dataset.num,
        color: p.dataset.color,
        left: p.style.left,
        top: p.style.top
      }));
      const labels = Array.from(document.querySelectorAll('.label')).map(l => ({
        text: l.textContent,
        left: l.style.left,
        top: l.style.top
      }));
      return { players, labels };
    }

    function saveBoard() {
      const data = collectBoardData();
      const blob = new Blob([JSON.stringify(data)], { type: 'application/json' });
      const a = document.createElement('a');
      a.href = URL.createObjectURL(blob);
      a.download = 'tactical_board.json';
      a.click();
      URL.revokeObjectURL(a.href);
    }

    function loadBoard(e) {
      const file = e.target.files[0];
      if (!file) return;
      const reader = new FileReader();
      reader.onload = evt => {
        const data = JSON.parse(evt.target.result);
        board.innerHTML = '';
        data.players.forEach(p => createPlayer(p.num, p.color, parseFloat(p.left), parseFloat(p.top)));
        data.labels.forEach(l => {
          const el = document.createElement('div');
          el.className = 'label';
          el.textContent = l.text;
          el.style.left = l.left;
          el.style.top = l.top;
          board.appendChild(el);
        });
      };
      reader.readAsText(file);
    }

    document.getElementById('saveBtn').onclick = saveBoard;
    document.getElementById('loadBtn').onclick = () => fileInput.click();
    fileInput.addEventListener('change', loadBoard);
    board.addEventListener('click', handleClick);

    window.onload = spawnInitialPlayers;
  </script>
</body>
</html>
