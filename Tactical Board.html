<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Tactical Board</title>
  <style>
    body {
      margin: 0;
      background: #111;
      font-family: Arial, sans-serif;
      overflow: hidden;
    }
    .toolbar {
      position: fixed;
      top: 10px;
      left: 10px;
      z-index: 1000;
    }
    .toolbar button {
      margin: 5px;
      padding: 10px;
      background: #00f0ff;
      color: black;
      border: none;
      font-weight: bold;
      cursor: pointer;
    }
    .toolbox-toggle {
      position: fixed;
      top: 10px;
      right: 10px;
      z-index: 1000;
      background: #00f0ff;
      border-radius: 50%;
      width: 40px;
      height: 40px;
      font-size: 24px;
      display: flex;
      justify-content: center;
      align-items: center;
      cursor: pointer;
    }
    .toolbox {
      position: fixed;
      top: 60px;
      right: -200px;
      width: 180px;
      background: rgba(0, 0, 0, 0.8);
      border: 1px solid #00f0ff;
      padding: 10px;
      transition: right 0.3s ease-in-out;
      z-index: 1000;
    }
    .toolbox.open {
      right: 10px;
    }
    .toolbox div {
      background: #444;
      color: #fff;
      padding: 8px;
      margin: 5px 0;
      text-align: center;
      cursor: grab;
      user-select: none;
    }
    .pitch {
      position: relative;
      width: 100vw;
      height: 100vh;
      background: url('—Pngtree—football pitch vector illustration design_6391956.png') no-repeat center center;
      background-size: contain;
    }
    .player {
      position: absolute;
      width: 40px;
      height: 40px;
      border-radius: 50%;
      color: white;
      font-weight: bold;
      display: flex;
      justify-content: center;
      align-items: center;
      cursor: move;
      z-index: 10;
    }
    .purple { background: purple; }
    .blue { background: blue; }
    .arrow {
      position: absolute;
      width: 60px;
      height: 4px;
      border-radius: 2px;
      transform: rotate(0deg);
    }
    .pass { background: lime; }
    .shoot { background: red; }
    .cross { background: gold; }
  </style>
</head>
<body>
  <div class="toolbar">
    <button onclick="saveBoard()">Save Board</button>
    <button onclick="loadBoard()">Load Board</button>
  </div>
  <div class="toolbox-toggle" onclick="toggleToolbox()">≡</div>
  <div class="toolbox" id="toolbox">
    <div draggable="true" ondragstart="startArrowDrag(event, 'pass')">Pass</div>
    <div draggable="true" ondragstart="startArrowDrag(event, 'shoot')">Shoot</div>
    <div draggable="true" ondragstart="startArrowDrag(event, 'cross')">Cross</div>
  </div>
  <div class="pitch" id="pitch"></div>
  <script src="https://cdn.jsdelivr.net/npm/interactjs/dist/interact.min.js"></script>
  <script>
    const pitch = document.getElementById('pitch');

    function createPlayer(number, team, x, y) {
      const el = document.createElement('div');
      el.className = `player ${team}`;
      el.textContent = number;
      el.style.left = `${x}px`;
      el.style.top = `${y}px`;
      pitch.appendChild(el);
      interact(el).draggable({
        listeners: {
          move(event) {
            const target = event.target;
            const x = (parseFloat(target.getAttribute('data-x')) || 0) + event.dx;
            const y = (parseFloat(target.getAttribute('data-y')) || 0) + event.dy;
            target.style.transform = `translate(${x}px, ${y}px)`;
            target.setAttribute('data-x', x);
            target.setAttribute('data-y', y);
          }
        }
      });
    }

    for (let i = 1; i <= 11; i++) {
      createPlayer(i, 'purple', 20, i * 50);
      createPlayer(i, 'blue', window.innerWidth - 60, i * 50);
    }

    function toggleToolbox() {
      document.getElementById('toolbox').classList.toggle('open');
    }

    function startArrowDrag(event, type) {
      event.dataTransfer.setData('arrowType', type);
    }

    pitch.ondragover = e => e.preventDefault();
    pitch.ondrop = function (e) {
      const type = e.dataTransfer.getData('arrowType');
      if (type) {
        const el = document.createElement('div');
        el.className = `arrow ${type}`;
        el.style.left = `${e.clientX - 30}px`;
        el.style.top = `${e.clientY - 2}px`;
        pitch.appendChild(el);
        interact(el).draggable({
          listeners: {
            move(event) {
              const target = event.target;
              const x = (parseFloat(target.getAttribute('data-x')) || 0) + event.dx;
              const y = (parseFloat(target.getAttribute('data-y')) || 0) + event.dy;
              target.style.transform = `translate(${x}px, ${y}px)`;
              target.setAttribute('data-x', x);
              target.setAttribute('data-y', y);
            }
          }
        });
      }
    }

    function saveBoard() {
      const items = [...document.querySelectorAll('.player, .arrow')].map(el => {
        return {
          class: el.className,
          x: parseFloat(el.getAttribute('data-x')) || 0,
          y: parseFloat(el.getAttribute('data-y')) || 0,
          text: el.textContent
        };
      });
      const blob = new Blob([JSON.stringify(items)], { type: 'application/json' });
      const a = document.createElement('a');
      a.href = URL.createObjectURL(blob);
      a.download = 'tactics_board.json';
      a.click();
    }

    function loadBoard() {
      const input = document.createElement('input');
      input.type = 'file';
      input.accept = '.json';
      input.onchange = e => {
        const file = e.target.files[0];
        const reader = new FileReader();
        reader.onload = () => {
          pitch.innerHTML = '';
          const data = JSON.parse(reader.result);
          data.forEach(obj => {
            if (obj.class.includes('player')) {
              createPlayer(obj.text, obj.class.includes('purple') ? 'purple' : 'blue', 0, 0);
              const el = pitch.lastChild;
              el.style.transform = `translate(${obj.x}px, ${obj.y}px)`;
              el.setAttribute('data-x', obj.x);
              el.setAttribute('data-y', obj.y);
            } else {
              const el = document.createElement('div');
              el.className = obj.class;
              el.style.left = '0px';
              el.style.top = '0px';
              el.style.transform = `translate(${obj.x}px, ${obj.y}px)`;
              el.setAttribute('data-x', obj.x);
              el.setAttribute('data-y', obj.y);
              pitch.appendChild(el);
              interact(el).draggable({
                listeners: {
                  move(event) {
                    const target = event.target;
                    const x = (parseFloat(target.getAttribute('data-x')) || 0) + event.dx;
                    const y = (parseFloat(target.getAttribute('data-y')) || 0) + event.dy;
                    target.style.transform = `translate(${x}px, ${y}px)`;
                    target.setAttribute('data-x', x);
                    target.setAttribute('data-y', y);
                  }
                }
              });
            }
          });
        };
        reader.readAsText(file);
      };
      input.click();
    }
  </script>
</body>
</html>
