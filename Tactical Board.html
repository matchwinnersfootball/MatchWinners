<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Tactical Board</title>

  <!-- Orbitron for consistency with the rest of your site -->
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500;700&display=swap" rel="stylesheet"/>

  <style>
    * { box-sizing: border-box; user-select: none; font-family: "Orbitron", sans-serif; }

    body {
      margin: 0;
      background: #0d0d0d;
      overflow: hidden;
      color: #fff;
    }

    /* --- Top toolbar ---------------------------------------------------- */
    #toolbar {
      position: fixed;
      top: 10px; left: 10px;
      z-index: 5;
      display: flex; gap: 8px;
    }
    button {
      background: #00f0ff;
      color: #000;
      border: none;
      padding: 8px 14px;
      font-weight: 700;
      border-radius: 6px;
      cursor: pointer;
    }
    button:hover { filter: brightness(1.1); }

    /* --- Pitch area ----------------------------------------------------- */
    #board {
      position: relative;
      width: 100vw;
      height: 100vh;
      background: url('—Pngtree—football pitch vector illustration design_6391956.png')
                  center center / contain no-repeat;
    }

    /* --- Players -------------------------------------------------------- */
    .player {
      position: absolute;
      width: 42px; height: 42px;
      border-radius: 50%;
      display: flex; align-items: center; justify-content: center;
      color: #fff; font-weight: 700;
      cursor: pointer;                        /* tap / click */
      transition: transform .15s ease;
    }
    .player.selected { transform: scale(1.25); box-shadow: 0 0 10px #00f0ff; }

    .purple { background: #7c3aed; }
    .blue   { background: #2563ff; }

    /* --- Responsive helper --------------------------------------------- */
    @media (max-width: 650px){
      .player{width:36px;height:36px;font-size:14px}
    }
  </style>
</head>
<body>

<!-- toolbar -->
<div id="toolbar">
  <button id="saveBtn">Save Board</button>
  <button id="loadBtn">Load Board</button>
  <input type="file" id="fileInput" accept="application/json" style="display:none" />
</div>

<!-- pitch -->
<div id="board"></div>

<script>
/* -------------------------------------------------------------
   1.  Create 11 purple + 11 blue players down each sideline
----------------------------------------------------------------*/
const board = document.getElementById("board");
const SIDE_PADDING = 15;
const ROW_GAP = 50;

function spawnPlayer(num, color, x, y){
  const p = document.createElement("div");
  p.className = `player ${color}`;
  p.textContent = num;
  p.style.left = x + "px";
  p.style.top  = y + "px";
  p.dataset.x = 0;             // translate offset
  p.dataset.y = 0;
  p.dataset.num = num;
  board.appendChild(p);
  return p;
}

const boardRect = board.getBoundingClientRect();
for(let i=1;i<=11;i++){
  spawnPlayer(i,"purple",SIDE_PADDING, i*ROW_GAP);
  spawnPlayer(i,"blue", boardRect.width - SIDE_PADDING - 42, i*ROW_GAP);
}

/* -------------------------------------------------------------
   2.  Tap‑to‑pick‑up, tap‑to‑drop logic
----------------------------------------------------------------*/
let selected = null;

board.addEventListener("click", e => {
  // Clicked on an existing player?
  if(e.target.classList.contains("player")){
    // 2a. If nothing selected → pick this one
    if(!selected){
      selected = e.target;
      selected.classList.add("selected");
    }
    // 2b. If same player tapped again → unselect
    else if(selected === e.target){
      selected.classList.remove("selected");
      selected = null;
    }
    // 2c. Different player tapped while holding one → swap positions
    else {
      const { left: x, top: y } = e.target.getBoundingClientRect();
      const { left: sx, top: sy } = selected.getBoundingClientRect();
      // swap CSS positions
      selected.style.left = x - boardRect.left + "px";
      selected.style.top  = y - boardRect.top  + "px";
      e.target.style.left = sx - boardRect.left + "px";
      e.target.style.top  = sy - boardRect.top  + "px";
      selected.classList.remove("selected");
      selected = null;
    }
  }
  // Clicked empty pitch while holding a player → drop there
  else if(selected){
    const clickX = e.clientX - boardRect.left - 21; // center circle
    const clickY = e.clientY - boardRect.top  - 21;
    selected.style.left = clickX + "px";
    selected.style.top  = clickY + "px";
    selected.classList.remove("selected");
    selected = null;
  }
});

/* -------------------------------------------------------------
   3.  Save / Load (download & upload JSON)
----------------------------------------------------------------*/
function collectPositions(){
  return [...document.querySelectorAll(".player")].map(el => ({
    num: el.dataset.num,
    color: el.classList.contains("purple") ? "purple" : "blue",
    x: parseFloat(el.style.left),
    y: parseFloat(el.style.top)
  }));
}

document.getElementById("saveBtn").onclick = () => {
  const blob = new Blob([JSON.stringify(collectPositions())],
                        {type:"application/json"});
  const a = Object.assign(document.createElement("a"), {
      href: URL.createObjectURL(blob),
      download: "tactics_board.json"
  });
  a.click();
  URL.revokeObjectURL(a.href);
};

document.getElementById("loadBtn").onclick =
  () => document.getElementById("fileInput").click();

document.getElementById("fileInput").addEventListener("change", e=>{
  const file = e.target.files[0];
  if(!file) return;
  const reader = new FileReader();
  reader.onload = evt=>{
    const data = JSON.parse(evt.target.result);
    board.innerHTML = "";      // clear current players
    data.forEach(p=>{
      spawnPlayer(p.num, p.color, p.x, p.y);
    });
  };
  reader.readAsText(file);
});
</script>
</body>
</html>
